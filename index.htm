<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Provas Bíblicas</title>

    <style>
        /* FORÇA TEXTO EM MAIÚSCULO (APENAS VISUAL) */
        #nome-participante {
            text-transform: uppercase;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding-top: 60px;
            background: #f4f6f9;
        }

        h2 {
            text-align: center;
            margin: 20px 0;
        }

        /* MENU SUPERIOR FIXO */
        #topbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 60px;
            background: #2c7be5;
            color: #fff;
            display: flex;
            align-items: center;
            padding: 0 20px;
            z-index: 10000;
        }

        .menu-item {
            margin-right: 30px;
            font-weight: bold;
            cursor: pointer;
            position: relative;
        
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }

        .menu-item:hover {
            text-decoration: underline;
        }

        /* SCROL MENU  */
       .dropdown-content {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        background: #fff;
        min-width: 250px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        border-radius: 6px;

        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        max-height: calc(100vh - 80px);

        z-index: 10001;
}

        .dropdown-content div {
            padding: 12px;
            color: #333;
            cursor: pointer;
        }

        .dropdown-content div:hover {
            background: #f0f0f0;
        }

        .menu-item.dropdown.open .dropdown-content {
            display: block;
        }
        
/* (removido) dropdown por hover não funciona bem no iOS */
        /* MENU PRINCIPAL COM ROLAGEM DE PAGINA */
        #inicio {
           position: fixed;
           top: 60px;
           left: 0;
           width: 100%;
           height: calc(100% - 60px);
           background: #f4f6f9;

           display: flex;
           align-items: flex-start;     /* antes era center */
           justify-content: center;

           overflow-y: auto;            /* ✅ ativa rolagem */
          -webkit-overflow-scrolling: touch; /* ✅ rolagem suave no iPhone */
           padding: 20px 0;             /* dá respiro no topo/baixo */
           z-index: 9999;
         }

        .menu-box {
            width: 100%;
            max-width: 900px;
            background: #fff;
            padding: 25px;
            border-radius: 14px;
	    margin: 0 12px; /* evita colar nas bordas no celular */
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            /* 4 cards lado a lado */
            gap: 15px;
        }

        .menu-card {
            border: 2px solid #2c7be5;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .menu-card h3 {
            margin: 10px 0 5px;
        }

        .menu-card p {
            margin-bottom: 15px;
            font-size: 14px;
        }

        button {
            padding: 14px;
            font-size: 16px;
            width: 100%;
            background: #2c7be5;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        /* TELA DE IDENTIFICAÇÃO */
        #tela-identificacao {
            position: fixed;
            top: 60px;
            left: 0;
            width: 100%;
            height: calc(100% - 60px);
            background: #f4f6f9;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            flex-direction: column;
            display: none;
        }

        #tela-identificacao .id-box {
            background: #fff;
            padding: 25px;
            border-radius: 14px;
            text-align: center;
            width: 90%;
            max-width: 500px;
            /* aumenta para respostas longas */
        }

        #tela-identificacao input {
            width: 90%;
            padding: 10px;
            margin: 15px 0;
            font-size: 16px;
            border-radius: 6px;
            border: 1px solid #ccc;
        }

        /* PROVA */
        #prova-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px;
            display: none;
            flex-wrap: wrap;
        }

        .column {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
            max-width: 500px;
            /* aumenta para respostas longas */
        }

        .question {
            display: none;
            padding: 12px;
            border-radius: 8px;
            background: #fff;
            border: 2px solid #2c7be5;
            word-wrap: break-word;
        }

        .question.active {
            display: block;
        }

        #finalizar-btn {
            display: none;
            margin: 20px auto;
            width: 200px;
        }

        /* RESULTADO */
        #resultado {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10002;
        }

        .result-box {
            background: #fff;
            padding: 25px;
            width: 90%;
            max-width: 450px;
            border-radius: 14px;
            text-align: center;
        }

        .pontos {
            font-size: 44px;
            font-weight: bold;
            color: #2c7be5;
            margin: 10px 0;
        }

        .result-text {
            font-size: 16px;
            margin: 8px 0;
        }

        .result-btn {
            margin: 10px;
            padding: 10px 20px;
            width: 80%;
            font-size: 16px;
            border: none;
            border-radius: 6px;
            background: #2c7be5;
            color: white;
            cursor: pointer;
        }

        /* RESULTADOS VISUALIZAÇÃO */
        #tela-resultados {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10003;
        }

        #tela-resultados .result-box {
            max-width: 700px;
            overflow-y: auto;
            max-height: 80%;
            text-align: left;
        }

        #tela-resultados .result-box h3 {
            text-align: center;
        }

        #tela-resultados .result-box div {
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
  .menu-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .menu-box {
    padding: 16px;
  }

  .menu-card {
    padding: 14px;
  }

  .menu-card p {
    font-size: 13px;
  }

  button {
    font-size: 15px;
    padding: 12px;
  }
}

@media (max-width: 420px) {
  .menu-grid {
    grid-template-columns: 1fr;
  }
}
    
    </style>
</head>

<body>

    <!-- MENU SUPERIOR FIXO -->
    <div id="topbar">
        <div class="menu-item" onclick="mostrarMenu()">Menu Inicial</div>

        <div class="menu-item dropdown" id="dd-provas">
            Provas ▼
<div class="dropdown-content" id="menu-provas-topo"></div>
</div>

        </div>

        <div class="menu-item dropdown" id="dd-resultados">
            Resultados ▼
            <div class="dropdown-content" id="menu-resultados">
                <div>Nenhum resultado disponível</div>
            </div>
        </div>
    </div>

    <!-- MENU PRINCIPAL -->
    <div id="inicio">
        <div class="menu-box">
            <div class="menu-grid" id="menu-categorias">
  <div class="menu-card">
    <h3>ESTUDO MARIA</h3>
    <p>PROVAS 1 A 5</p>
    <button onclick="abrirCategoria('maria')">ENTRAR</button>
  </div>

  <div class="menu-card">
    <h3>ENSINOS DE JESUS</h3>
    <p>PROVAS 1 A 18</p>
    <button onclick="abrirCategoria('jesus')">ENTRAR</button>
  </div>
</div>

<!-- SUBMENU (LISTA DE PROVAS DA CATEGORIA) -->
<div id="submenu-provas" style="display:none;">
  <h2 id="titulo-categoria" style="margin-top:0;"></h2>
  <div class="menu-grid" id="menu-provas-categoria"></div>
  <div style="margin-top:15px;">
    <button onclick="voltarCategorias()">VOLTAR</button>
  </div>
</div></div>
        </div>
    </div>

    <!-- TELA DE IDENTIFICAÇÃO -->
    <div id="tela-identificacao">
        <div class="id-box">
            <h3 id="id-titulo">Prova</h3>
            <p>Antes de começar, digite seu nome:</p>
            <input type="text" id="nome-participante" placeholder="Nome do participante" oninput="this.value = this.value.toUpperCase()">
            <button onclick="iniciarProva()">INICIAR PROVA</button>
        </div>
    </div>

    <!-- PROVA -->
    <div id="prova-container">
        <div class="column" id="col-left"></div>
        <div class="column" id="col-right"></div>
    </div>

    <button id="finalizar-btn" onclick="finalizarProva()">Finalizar Prova</button>

    <!-- RESULTADO -->
    <div id="resultado">
        <div class="result-box">
            <h3 id="res-title">Resultado</h3>
            <div class="result-text" id="res-participante">Participante: </div>
            <div class="pontos" id="res-nota">0 / 10</div>
            <div class="result-text" id="res-tempo">Tempo: 0 segundos</div>
            <div class="result-text" id="res-status">Status: REPROVADO</div>
            <div class="result-text" id="res-msg">Você não atingiu a nota mínima.</div>
            <button class="result-btn" onclick="refazerProva()">REFAZER A PROVA</button><br>
            <button class="result-btn" onclick="proximaProva()">PRÓXIMA PROVA</button><br>
            <button class="result-btn" onclick="mostrarMenu()">MENU PRINCIPAL</button>
        </div>
    </div>

    <!-- TELA RESULTADOS -->
    <div id="tela-resultados">
        <div class="result-box">
            <h3>Resultados das Provas</h3>
            <div id="lista-resultados"></div>
            <button class="result-btn" onclick="fecharResultados()">VOLTAR AO MENU PRINCIPAL</button>
        </div>
    </div>

    <script>
        let inicioTempo;
        let atualProva = 1; // ID REAL (1..23) ainda usado para buscar em "provas"
        let provaIdAtual = "";
        let categoriaAtual = "";
        let ordemAtual = 0; // ordem dentro da categoria (Maria 1..5 / Jesus 1..18)
        let nomeParticipante = "";
        let resultados = {};
/* GOOGLE SHEETS (API) */
        const GOOGLE_SHEETS_URL = "https://script.google.com/macros/s/AKfycbwTQlB-57ZPHr5U6nF2ALF3BkwaVZxG9QzU5duGvUz4WefT6OC4b9eFMu0eRhXvKfsERA/exec";

        const provas = {
            1: [ // Prova 1 – A Criação
                ["Quem é Deus?", ["Uma força", "Um poder", "Um espírito", "Todas as alternativas"], 3],
                ["Quais as 3 manifestações de Deus?", ["Deus", "Jesus", "Espírito Santo", "Todas as alternativas"], 3],
                ["Como Deus criou o planeta Terra?", ["Passe de mágica", "Soprou", "Pela sua palavra", "Chamou Adão"], 2],
                ["Quantos dias Deus criou?", ["6 dias", "8 dias", "7 dias", "5 dias"], 2],
                ["Como a Terra estava antes da criação?", ["Escura", "Sem forma", "Vazia", "Todas as alternativas"], 3],
                ["O que Deus criou no sexto dia?", ["Lua e sol", "Águas e terra", "Plantas", "O homem e a mulher"], 3],
                ["O que Deus fez no sétimo dia?", ["Abençoou e santificou", "Descansou, abençoou e santificou", "Somente descansou", "Nada"], 1],
                ["Primeiro homem criado por Deus?", ["Jesus", "Éden", "Adão", "Abel"], 2],
                ["Primeira mulher?", ["Erva", "Eva", "Evra", "Evã"], 1],
                ["Presente dado por Deus?", ["Animais", "Cordeiro", "Jardim do Éden", "Árvore da vida"], 2]
            ],
            2: [ // Prova 2 – O Jardim do Éden
                ["Com quais animais Adão e Eva conversavam no jardim?", ["Com o leão", "Com os pássaros", "Com a serpente", "Nenhuma das alternativas pois eles não falavam"], 3],
                ["Qual a função de Adão e Eva com o jardim?", ["Avisar Deus se uma árvore cair", "Fazer casas", "Cuidar", "Todas as alternativas"], 2],
                ["Qual aviso Deus deu para Adão e Eva?", ["Não coma nenhum fruto de nenhuma árvore", "Coma do fruto da árvore do conhecimento do bem e do mal", "Ensine os animais a falarem", "Nenhuma das alternativas"], 3],
                ["O que aconteceu com Eva e a serpente?", ["Eles estavam conversando", "Eva deu um fruto para a serpente", "A serpente deu um fruto para Eva", "Eva chamou Adão para expulsar a serpente"], 0],
                ["Quem comeu o fruto que não poderia comer?", ["Eva e a serpente", "Eva, Adão e a serpente", "Eva, Adão e o Cordeiro", "Nenhuma das alternativas"], 3],
                ["Qual foi a frase de Deus para Adão e Eva?", ["Coma todos os frutos das árvores do jardim livremente", "Coma somente o fruto da árvore da vida", "Não coma o fruto da árvore do entendimento do bem e do mal", "Não coma o fruto da árvore do conhecimento do bem e do mal"], 3],
                ["O que aconteceria se comer da árvore do conhecimento do bem e do mal?", ["Certamente a serpente morreria", "Certamente a árvore cairia", "Certamente morrerás", "Certamente vai sair do jardim do Éden"], 2],
                ["Qual foi a intenção da serpente?", ["Mentir", "Mudar a ordem de Deus", "Enganar", "Todas as alternativas"], 3],
                ["Depois que Adão e Eva comeram o fruto, o que aconteceu?", ["Eva e Adão foram chamar Deus", "Eva se retirou e a serpente saiu voando", "Adão achou Eva caída no jardim", "Nenhuma das alternativas"], 3],
                ["Quando Deus chamou Adão e Eva, onde eles estavam?", ["Escondido em cima da maior árvore", "Escondidos atrás da árvore do conhecimento do bem e do mal", "Escondidos", "Escondidos perto do rio"], 2]
            ],
            3: [ // Prova 3 – O Pecado
                ["Quem foi o animal usado por Satanas para falar com a mulher?", ["Um leão", "Um macaco", "Uma serpente", "Um pássaro"], 2],
                ["Qual foi a primeira pergunta feita pela serpente à mulher?", ["Deus criou todas as coisas?", "Foi assim que Deus disse: Não comereis de toda árvore do jardim?", "Onde está Adão?", "Por que vocês estão no jardim?"], 1],
                ["O que a serpente disse que aconteceria se o fruto fosse comido?", ["Eles morreriam imediatamente", "Eles se tornariam anjos", "Seus olhos se abririam e seriam como Deus", "O jardim desapareceria"], 2],
                ["Após comerem do fruto, o que aconteceu primeiro com Adão e Eva?", ["Foram expulsos do jardim", "Seus olhos se abriram", "Deus apareceu imediatamente", "Eles dormiram"], 1],
                ["O que Adão e Eva fizeram ao perceberem que estavam nus?", ["Costuraram folhas de figueira", "Usaram peles de animais", "Pediram roupas a Deus", "Fugiram do jardim"], 0],
                ["Onde Adão e Eva se esconderam quando ouviram a voz de Deus?", ["Atrás das árvores do jardim", "Fora do jardim", "Dentro do rio", "Em uma caverna"], 0],
                ["Qual foi a justificativa de Adão para ter comido do fruto?", ["A serpente o enganou", "Ele estava com fome", "A mulher que Deus lhe deu lhe ofereceu", "Ele não sabia da ordem de Deus"], 2],
                ["Quem Eva culpou por ter comido do fruto?", ["Adão", "Deus", "A serpente", "Ela mesma"], 2],
                ["Qual foi a maldição dada à serpente?", ["Ser lançada no fogo", "Perder a fala", "Andar sobre o ventre e comer pó", "Ser expulsa do jardim"], 2],
                ["O que Deus colocou no jardim após expulsar o homem?", ["Um muro de fogo", "Um anjo com espada flamejante", "Um dilúvio", "Uma nuvem escura"], 1]
            ],
            4: [ // Prova 4 – Filhos de Adão e Eva
                ["Quem foram os dois primeiros filhos de Adão e Eva mencionados em Gênesis 4?", ["Cain e Abel", "Caim e Abel", "Kaim e Abeu", "Caim e Habel"], 1],
                ["Qual era a ocupação de Caim?", ["Pastor de ovelhas", "Caçador", "Lavrador da terra", "Construtor"], 2],
                ["Qual era a ocupação de Abel?", ["Lavrador", "Pastor de ovelhas", "Pescador", "Comerciante"], 1],
                ["Qual oferta Deus aceitou?", ["A de Caim", "A de Abel", "As duas ofertas", "Nenhuma das ofertas"], 1],
                ["Como Caim reagiu quando Deus não aceitou sua oferta?", ["Alegrou-se", "Ignorou", "Ficou muito irado", "Pediu perdão"], 2],
                ["O que Deus disse que o pecado estava fazendo?", ["Estava sendo perdoado", "Estava adormecido", "Estava à porta, desejando dominá-lo", "Estava distante do homem"], 2],
                ["O que Caim fez com Abel?", ["Planejou e matou ele", "Encontrou ele morto no jardim", "Encontrou ele morto no campo", "Sem querer matou ele"], 0],
                ["Onde Caim matou Abel?", ["Na cidade", "No templo", "No campo", "No jardim"], 2],
                ["Qual foi a resposta de Caim quando Deus perguntou por Abel?", ["Ele está no campo", "Não sei; sou eu guardador do meu irmão?", "Ele fugiu", "Ele morreu"], 1],
                ["Qual foi a consequência direta imposta a Caim após o assassinato?", ["Morte imediata", "Prisão", "Tornar-se fugitivo e errante", "Expulsão do Éden"], 2]
            ],
            5: [ // Prova 5 – Guerra no Céu
                ["Como é descrito o anjo que iniciou guerra no Céu?", ["Anjo mensageiro", "Querubim", "Arcanjo", "Gabriel"], 1],
                ["Qual foi o desejo expresso pelo ser querubim?", ["Servir aos homens", "Habitar acima dos anjos", "Guardar o trono de Deus", "Exaltar-se acima das estrelas de Deus"], 3],
                ["Esse querubim é identificado como?", ["Um animal simbólico", "Um querubim fiel", "Dragão, a antiga serpente, chamada Diabo e Satanás", "Um anjo de Miguel"], 2],
                ["O querubim desejou ser?", ["Poderoso mais que Deus", "Ter mais autoridade que Deus", "Tomar o trono de Deus", "Todas as alternativas"], 3],
                ["Quem lutou contra o dragão e seus anjos no céu?", ["Miguel e seus anjos", "Gabriel e seus anjos", "Os vinte e quatro anciãos", "Os querubins do Éden"], 0],
                ["Qual foi o resultado da peleja no céu?", ["O querubim venceu", "O querubim perdeu o seu lugar no céu", "Houve empate", "O céu foi destruído"], 1],
                ["Para onde o dragão e seus anjos foram lançados após a derrota?", ["Para o lago de fogo", "Para o abismo imediatamente", "Para a terra", "Para o deserto do Sinai"], 2],
                ["O que aconteceu com o dragão após ser lançado à terra?", ["Passou a perseguir os habitantes da terra", "Perdeu todo o poder", "Foi destruído imediatamente", "Voltou ao céu"], 0],
                ["Por que o diabo desce à terra com grande ira?", ["Porque perdeu seus anjos", "Porque foi expulso do Éden", "Porque sabe que tem pouco tempo", "Porque perdeu seu poder"], 2],
                ["Qual verdade espiritual a peleja no céu revela?", ["Os anjos são iguais aos homens", "Deus perdeu o controle por um tempo", "O céu pode ser destruído", "O mal não prevalece contra o propósito de Deus"], 3]
            ],
                        6: [ // Lição 1 – O que JESUS ensinou sobre as ESCRITURAS
              ["Qual era a Bíblia que Jesus usava? Mateus 5:17; 7:12.", ["O Novo Testamento.", "Apenas o Pentateuco.", "“A Lei e os Profetas” (o Antigo Testamento)."], 2],
              ["Quem levou os profetas a escrever o livro sagrado? 2 Pedro 1:21.", ["Os anjos.", "O Espírito Santo.", "Os sábios antigos."], 1],
              ["Quais são os benefícios trazidos pelo estudo da Bíblia? 2 Timóteo 3:15-17.", ["A Bíblia não traz benefícios, apenas contém informações.", "É útil para o ensino, para repreensão e para educação na justiça.", "Quem estuda a Bíblia não precisa de repreensão."], 1],
              ["Por quanto tempo a Palavra de Deus teria validade? Mateus 24:35; Isaías 40:8.", ["Para sempre.", "Apenas os evangelhos são relevantes para os nossos dias.", "O Antigo Testamento não tem mais valor."], 0]
            ],

            7: [ // Lição 2 – O QUE JESUS ENSINOU SOBRE A SALVAÇÃO
              ["Qual é a situação da natureza humana após o pecado? Gênesis 6:5; Salmo 51:5; Mateus 15:19.", ["Nosso coração é corrupto.", "O pecado traz separação entre a criatura e seu Criador.", "Todas as alternativas estão corretas."], 2],
              ["Que plano Deus estabeleceu para salvar o ser humano da morte eterna? João 3:16.", ["O pecado é tão terrível que não há solução para ele.", "Deus escreveu diversas normas e leis para nos salvar do pecado.", "Deus enviou Seu Filho para morrer em nosso lugar."], 2],
              ["A salvação depende de nossas obras? Efésios 2:8, 9; Gálatas 2:16.", ["Sim. As obras somam pontos para a nossa salvação.", "Não. Somos salvos pela graça de Deus independente das obras.", "Somos justificados unicamente pelas obras da lei."], 1],
              ["Como o ser humano pode alcançar a salvação? Atos 16:31; 1 João 5:11, 12.", ["Devemos apenas crer e confiar em Cristo.", "Através da prática das boas obras.", "Fazendo penitências e jejuns."], 0]
            ],

            8: [ // Lição 3 – O QUE JESUS ENSINOU SOBRE A SANTIFICAÇÃO
              ["Que oração Jesus fez pelos discípulos? João 17:17.", ["Santifica-os através dos ritos religiosos.", "“Santifica-os na verdade; a Tua Palavra é a verdade.”", "Nenhuma das alternativas está correta."], 1],
              ["Por que precisamos da santificação? Hebreus 12:14.", ["Pouco necessária; Deus não está preocupado com isso.", "É essencial: sem santificação também não há salvação.", "Tanto faz: a necessidade está ligada aos nossos sentimentos."], 1],
              ["De quem é a obra de santificar? 1 Tessalonicenses 5:23.", ["A obra é unicamente humana.", "A santificação ocorre mediante a meditação transcendental.", "A obra é divina, mediante a atuação do Espírito Santo no coração."], 2],
              ["Qual o conselho que o apóstolo Pedro nos dá? 2 Pedro 3:18.", ["Cristianismo envolve apenas a prática, não o conhecimento.", "Devemos crescer na graça e no conhecimento de Jesus.", "Quem aceitou a Jesus, não precisa mais guardar a lei."], 1]
            ],

            9: [ // Lição 4 – O QUE JESUS ENSINOU SOBRE O ESPÍRITO SANTO
              ["Que promessa Jesus fez aos discípulos? João 14:16, 17.", ["O Espírito Santo seria enviado pelo Pai.", "O Espírito Santo também é chamado de “Consolador” e “Espírito da verdade”.", "Todas as alternativas estão corretas."], 2],
              ["Qual seria a obra do Espírito Santo? João 14:26; 16:8, 13.", ["Ensinar que o Antigo Testamento não tem mais valor.", "Ensinar toda a verdade e nos convencer do pecado, da justiça e do juízo.", "Mostrar que a graça de Deus nos libera para pecarmos."], 1],
              ["A quem Deus concede exclusivamente Seu Espírito? Atos 5:32.", ["Àqueles que obedecem a Deus.", "Àqueles que falam a língua dos anjos.", "Àqueles que frequentam a igreja semanalmente."], 0],
              ["Segundo Jesus, para qual pecado não haveria perdão? Mateus 12:31, 32.", ["Adultério.", "Homicídio.", "O pecado contra o Espírito Santo."], 2]
            ],

            10: [ // Lição 5 – O QUE JESUS ENSINOU SOBRE A ORAÇÃO
              ["Que pedido os discípulos fizeram a Jesus? Lucas 11:1.", ["Pediram um lugar especial no reino messiânico.", "“Ensina-nos a orar”.", "Pediram poder sobrenatural para realizar sinais e prodígios."], 1],
              ["Que oração Jesus ensinou aos discípulos? Lucas 11:2-4.", ["A oração dominical, ou “oração-modelo”.", "O “Pai Nosso” é a única oração que deve ser feita.", "A “oração-modelo” não serve de parâmetro, pois nossas orações devem ser livres."], 0],
              ["Que tipo de oração Jesus ensinou no Sermão do Monte? Mateus 6:5-8.", ["A oração nas praças.", "A oração particular ou secreta.", "A oração feita nos cultos da igreja."], 1],
              ["Que promessa maravilhosa Jesus fez com relação às nossas petições? Mateus 21:22.", ["“E tudo quanto pedirdes em oração, crendo, recebereis”.", "Jesus nos concede todas as bênçãos sem pedirmos.", "Tudo o que queremos será concedido."], 0]
            ],

            11: [ // Lição 6 – O QUE JESUS ENSINOU SOBRE O PERDÃO
              ["Que oração Davi fez depois de haver pecado contra Deus? Salmo 51:1, 2, 10.", ["Reconheceu o pecado cometido e o confessou a Deus.", "Confessou seus pecados ao sacerdote, não a Deus.", "Davi agradeceu a Deus por ignorar a sua transgressão."], 0],
              ["Quem somente pode perdoar pecados? Salmo 130:4; Marcos 2:7.", ["Um líder religioso consagrado ao ministério.", "Não existe pecado, pois não existe lei.", "Jesus Cristo."], 2],
              ["O que é necessário, segundo a Bíblia, para se alcançar a remissão dos pecados? Atos 2:38.", ["Antes de irmos a Cristo, precisamos nos arrepender dos pecados.", "Precisamos do verdadeiro arrependimento, que é uma obra divina no coração.", "O arrependimento não é uma condição para recebermos o perdão de Deus."], 0],
              ["Quantas vezes devo perdoar a quem me ofende? Mateus 18:21, 22.", ["Três vezes, conforme o ensinamento na época de Cristo.", "Sete vezes, que é o número da perfeição.", "“Até setenta vezes sete”, ou seja, perdoar da mesma forma como Deus nos perdoa."], 2]
            ],

            12: [ // Lição 7 – O QUE JESUS ENSINOU SOBRE O DINHEIRO
              ["Como o dízimo era usado em Israel? Números 18:21.", ["Era destinado à tribo de Levi, que servia ao Senhor em tempo integral.", "Apenas o sumo sacerdote tinha direito ao dízimo.", "Era destinado como herança para as tribos de Israel."], 0],
              ["O que Paulo afirma sobre o sustento do ministério evangélico? 1 Coríntios 9:13, 14.", ["O dízimo é destinado àqueles que trabalham em tempo integral para Deus.", "Os que prestam serviços sagrados se sustentam do próprio templo.", "Todas as alternativas estão corretas."], 2],
              ["Além do dízimo, o que mais devemos trazer ao Senhor? Salmos 96:8; Malaquias 3:8.", ["Ofertas de gratidão que são voluntárias e proporcionais às bênçãos divinas.", "Deus não precisa das nossas ofertas, por isso, não precisamos levá-las à igreja.", "Ofertas definidas de acordo com a bênção que desejamos ganhar de Deus."], 0],
              ["Para Jesus, qual é a essência da verdadeira oferta? Lucas 21:1-4.", ["Deus quer o que sobra, não o que é dado com sacrifício.", "A essência não está na quantidade, mas na entrega do coração.", "A oferta demonstra o status econômico que possuímos."], 1]
            ],

            13: [ // Lição 8 – O QUE JESUS ENSINOU SOBRE SUA VOLTA
              ["Jesus ensinou que Sua volta seria um evento secreto? Mateus 24:27; Apocalipse 1:7.", ["Sim, Jesus virá secretamente e arrebatará da mesma forma os salvos.", "Não, Jesus voltará de forma literal, visível e audível, com grande poder e glória.", "A volta de Jesus será invisível, pois será espiritual e não corporal."], 1],
              ["O que acontecerá com os justos que estiverem vivos? 1 Coríntios 15:51-53.", ["Serão arrebatados secretamente.", "Irão para o Céu com o corpo mortal.", "Serão transformados num “abrir e fechar de olhos”."], 2],
              ["O que acontecerá com os ímpios que estiverem vivos? 2 Tessalonicenses 2:8.", ["Estarão tranquilos, pois terão uma segunda chance de arrependimento.", "Serão mortos pela manifestação da vinda de Cristo.", "Nenhuma das alternativas está correta."], 1],
              ["O que acontecerá com os justos que estiverem mortos? 1 Tessalonicenses 4:15, 16.", ["Serão ressuscitados com o corpo incorruptível e imortal.", "Não haverá ressurreição, pois os justos já estarão no Céu.", "Não existe ressurreição do corpo, mas do espírito."], 0]
            ],

            14: [ // Lição 9 – O QUE JESUS ENSINOU SOBRE A MORTE
              ["A que Jesus comparou a morte de Lázaro? João 11:11-13.", ["Ao início do processo de reencarnação.", "A um sono.", "A entrada do mundo espiritual."], 1],
              ["Segundo a Bíblia, o ser humano é mortal ou imortal? Ezequiel 18:4, 20.", ["Mortal, pois somos pecadores.", "O corpo morre, mas o espírito permanece vivo.", "Mesmo após a entrada do pecado, não perdemos a imortalidade."], 0],
              ["Como a Bíblia descreve o estado dos mortos? Salmo 6:5; Eclesiastes 9:5.", ["Os mortos não falam, não têm sentimentos e não se lembram de nada.", "A ideia de que a alma sai do corpo e continua viva não é bíblica.", "Todas as alternativas estão corretas."], 2],
              ["O que acontece na morte do ser humano? Gênesis 3:19; Salmo 146:4; Eclesiastes 12:7.", ["O pó volta para a terra e o espírito (fôlego de vida) volta para Deus.", "O espírito continua vagando, pois é uma entidade extracorpórea.", "Apenas o corpo morre. A alma é imortal."], 0]
            ],

            15: [ // Lição 10 – O QUE JESUS ENSINOU SOBRE A RESSURREIÇÃO
              ["O que Jesus ensinou sobre a ressurreição? João 5:28, 29.", ["Haverá duas ressurreições: a primeira, da vida; e a segunda, do juízo.", "Cada pessoa receberá sua recompensa na hora da morte.", "Haverá apenas uma ressurreição."], 0],
              ["Quando ocorrerá a primeira ressurreição e quem ressuscitará nela? 1 Tessalonicenses 4:16.", ["A primeira ressurreição será de todos ímpios, pois verão a volta de Jesus.", "A primeira ressurreição será dos justos e ocorrerá na volta de Jesus.", "Jesus voltará secretamente, por isso a ressurreição será apenas espiritual."], 1],
              ["Quando ocorrerá a segunda ressurreição e quem ressuscitará nela? Apocalipse 20:5, 6.", ["Durante os mil anos, os ímpios serão ressuscitados e permanecerão na Terra.", "Todos os ímpios ressuscitarão na volta de Jesus, antes dos mil anos.", "Após os mil anos, os ímpios de todas as eras serão ressuscitados."], 2],
              ["O que acontecerá com os ímpios que ressuscitarem? Apocalipse 20:7-10.", ["Marcharão pela superfície da terra e cercarão a Nova Jerusalém.", "Serão destruídos pelo fogo enviado por Deus.", "Todas as alternativas estão corretas."], 2]
            ],

            16: [ // Lição 11 – O QUE JESUS ENSINOU SOBRE O JUÍZO
              ["Quantos deverão enfrentar o juízo divino? 2 Coríntios 5:10.", ["Apenas os justos.", "Apenas os ímpios.", "Todas as pessoas."], 2],
              ["Por quais coisas as pessoas serão julgadas? Eclesiastes 12:13, 14; Mateus 12:36, 37.", ["Deus julgará as obras boas e más.", "No juízo divino até as obras escondidas serão levadas em conta.", "Todas as alternativas estão corretas."], 2],
              ["Qual será a norma usada por Deus no juízo? Eclesiastes 12:13; Tiago 1:25; 2:10-12.", ["A sinceridade.", "A lei de Deus.", "A quantidade de dízimos e ofertas que devolvemos."], 1],
              ["Que forte apelo o apóstolo Pedro faz a nós? 2 Pedro 3:7, 11-13.", ["Devemos viver em santo procedimento e piedade.", "Deus não quer que ninguém pereça, por isso não haverá julgamento.", "Devemos ter medo do juízo, pois ele serve apenas para condenar."], 0]
            ],

            17: [ // Lição 12 – O QUE JESUS ENSINOU SOBRE A LEI
              ["O que Cristo ensinou a respeito da lei? Mateus 5:17, 18.", ["Cristo veio para abolir a lei.", "A lei já caducou, mas o ensinamento dos profetas ainda permanece.", "Cristo veio para cumprir a lei, ou seja, praticá-la."], 2],
              ["Cristo guardou a Lei? João 15:10.", ["Sim, mas apenas porque era judeu.", "Sim. Cristo guardou os mandamentos do Pai e permaneceu no amor Dele.", "Não. A lei teve fim no Antigo Testamento."], 1],
              ["O que Jesus ensinou sobre a obediência aos mandamentos? João 14:15, 21.", ["Se amamos a Cristo, guardaremos os Seus mandamentos.", "Os mandamentos são penosos e difíceis de serem guardados.", "A obediência é irrelevante, pois o que vale é o amor de Deus."], 0],
              ["Se a lei de Deus não foi abolida, qual é a sua função? Gálatas 3:24; Romanos 3:20; 7:7.", ["Conduzir o pecador a Cristo.", "Pela lei vem o pleno conhecimento do pecado.", "Todas as alternativas estão corretas."], 2]
            ],

            18: [ // Lição 13 – O QUE JESUS ENSINOU SOBRE O SÁBADO
              ["Como Jesus engrandeceu a lei? Mateus 5:21, 22, 27, 28.", ["Em Seus discursos, Jesus nunca abordou o assunto da lei.", "Jesus mostrou a natureza espiritual da lei e tornou claro que ela é eterna.", "Ele mostrou que a “letra da lei” é mais importante do que sua natureza espiritual."], 1],
              ["O que Jesus disse acerca do quarto mandamento da lei? Marcos 2:27, 28.", ["O Filho do Homem também é Senhor do sábado.", "O sábado foi abolido.", "O homem pode guardar qualquer dia da semana."], 0],
              ["Jesus alguma vez transgrediu o sábado? Marcos 3:2-5.", ["Sim, pois Ele realizou diversas curas nesse dia.", "Sim, Jesus mostrou que a graça é maior que o sábado.", "Não. Ao curar no sábado, Jesus mostrou que devemos fazer o bem nesse dia."], 2],
              ["Que profecia em Daniel envolve a lei de Deus? Daniel 7:25, 8:12.", ["A lei seria abolida na cruz.", "O próprio Deus mudaria a Sua lei.", "Um “pequeno chifre” (poder religioso) mudaria a lei."], 2]
            ],

            19: [ // Lição 14 – O QUE JESUS ENSINOU SOBRE A IGREJA
              ["Quem é o fundador da igreja cristã? Mateus 16:16, 18.", ["Pedro.", "Paulo.", "Jesus Cristo."], 2],
              ["Quem o apóstolo Paulo reconhece como o fundamento da igreja? Efésios 2:19-21.", ["Cristo é a pedra angular, e os apóstolos e profetas edificaram seus fundamentos.", "Os fariseus e saduceus, que mantinham a religião judaica.", "Deus não tem uma igreja na Terra, por isso não há nenhum fundamento."], 0],
              ["Qual é o grande desejo de Cristo para Sua igreja? Efésios 5:27.", ["Cristo quer uma igreja igual ao mundo, defeituosa, que ama os prazeres.", "Cristo quer uma igreja livre e que faz o que bem entende.", "Cristo quer uma igreja pura, santa, que revela Seu caráter."], 2],
              ["Quais são as características bíblicas da igreja verdadeira?", ["Guarda todos os mandamentos da lei de Deus (Apocalipse 12:17; 14:12).", "Tem o testemunho de Jesus que é o Espírito de Profecia (Apocalipse 12:17; 19:10).", "Todas as alternativas estão corretas."], 2]
            ],

            20: [ // Lição 15 – O QUE JESUS ENSINOU SOBRE OS PROFETAS
              ["A que Jesus comparou os falsos profetas? Mateus 7:15.", ["Sepulcros caiados.", "Raça de víboras.", "Lobos roubadores disfarçados em ovelhas."], 2],
              ["O que Joel profetizou sobre os dias finais da história humana? Joel 2:28-32.", ["O Espírito Santo seria derramado apenas no Pentecostes.", "Joel mencionou que o Espírito Santo seria retirado dos justos.", "O Espírito será derramado e o dom de profecia será concedido."], 2],
              ["Quais são as duas características da igreja verdadeira? Apocalipse 12:17; 19:10.", ["Guarda os mandamentos de Deus e tem espírito de profecia (dom profético).", "Recebe o dom de línguas e opera milagres.", "Ensina a imortalidade da alma e o domingo como dia de guarda."], 0],
              ["Quais são os testes bíblicos para um verdadeiro profeta?", ["Tudo que ensina deve estar em harmonia com a Bíblia (Isaías 8:20).", "É conhecido por seus frutos (Mateus 7:20).", "Todas as alternativas estão corretas."], 2]
            ],

            21: [ // Lição 16 – O QUE JESUS ENSINOU SOBRE O BATISMO
              ["Que circunstâncias envolveram o batismo de Jesus? Mateus 3:13-17.", ["Jesus foi batizado por imersão, ou seja, foi mergulhado e “logo saiu da água”.", "Jesus não tinha pecados, mas foi batizado para nos dar o exemplo.", "Todas as alternativas estão corretas."], 2],
              ["Jesus via o batismo como condição para a salvação? Marcos 16:16; João 3:5.", ["Não. O que importa é aceitar a Jesus e permanecer na velha vida.", "Sim. Quem não nasce da água e do Espírito não pode entrar no reino de Deus.", "Não. O batismo é invenção das igrejas e não é necessário."], 1],
              ["Em nome de quem as pessoas devem ser batizadas? Mateus 28:19-20.", ["Em nome da igreja.", "Em nome do líder religioso.", "Em nome do Pai, do Filho e do Espírito Santo."], 2],
              ["A partir de qual idade pode-se receber o batismo? Atos 22:16.", ["Recém-nascidos já podem ser batizados.", "Aos quatro anos de idade.", "Quando tiver idade para entender e aceitar o plano de salvação em Cristo Jesus."], 2]
            ],

            22: [ // Lição 17 – O QUE JESUS ENSINOU SOBRE O CUIDADO COM O CORPO
              ["O que Jesus deseja para cada um de nós? João 10:10.", ["Jesus não Se importa com nosso corpo, apenas com a vida espiritual.", "Jesus deseja que tenhamos vida em abundância.", "A “vida em abundância” mencionada por Jesus significa prosperidade financeira."], 1],
              ["O que Paulo ensinou sobre o cuidado com nosso corpo? 1 Coríntios 6:19-20.", ["Somos livres para cuidarmos do corpo da forma como acharmos melhor.", "O corpo pertence a nós mesmos, não a Deus.", "O corpo é o templo do Espírito Santo."], 2],
              ["Qual foi a alimentação que Deus ofereceu ao ser humano assim que o criou? Gênesis 1:29; 2:9", ["Apenas vegetais.", "Carne vermelha", "Peixes e mariscos."], 0],
              ["O que Jesus deseja para cada um de Seus filhos? Êxodo 15:26; 3 João 2.", ["Deseja apenas a nossa saúde espiritual.", "Deseja que tenhamos saúde e que nenhuma enfermidade venha sobre nós.", "Jesus quer que gastemos todos os nossos recursos em médicos e remédios."], 1]
            ],

            23: [ // Lição 18 – O QUE JESUS ENSINOU SOBRE RITOS E TRADIÇÕES
              ["Qual o significado da dedicação de crianças? Salmo 127:3; Isaías 8:18.", ["Um compromisso assumido pelos pais de ensinar à criança o caminho de Deus.", "A dedicação dos filhos a Deus ocorre no batismo de recém-nascidos.", "A dedicação de uma criança não tem relação com os ensinamentos bíblicos."], 0],
              ["O que Jesus instituiu no lugar da Páscoa? João 13:4, 5, 15.", ["A circuncisão.", "A Santa Ceia.", "A ordenação."], 1],
              ["O que Cristo disse sobre o casamento? Mateus 19:4-6.", ["“O Criador, desde o princípio, os fez homem e mulher”.", "“Deixará o homem pai e mãe e se unirá à sua mulher”.", "Todas as alternativas estão corretas."], 2],
              ["Que funções Jesus designou para os discípulos? Marcos 3:14.", ["Concedeu riquezas e bens como incentivo à prática do ministério.", "“Designou doze para estarem com Ele e para os enviar a pregar”.", "Separou doze homens apenas para curar os doentes, não para pregar."], 1]
            ],
        };

                // ================== CATÁLOGO (ID TÉCNICO) ==================
// Regra: "id" é imutável; "ordem" pode mudar sem quebrar resultados.
const PROVAS_CATALOG = [
    // ESTUDO MARIA (reais 1..5)
    { id: "maria_criacao",      categoria: "maria", ordem: 1, real: 1, titulo: "A Criação" },
    { id: "maria_eden",         categoria: "maria", ordem: 2, real: 2, titulo: "O Jardim do Éden" },
    { id: "maria_pecado",       categoria: "maria", ordem: 3, real: 3, titulo: "O Pecado" },
    { id: "maria_filhos",       categoria: "maria", ordem: 4, real: 4, titulo: "Filhos de Adão e Eva" },
    { id: "maria_guerra_ceu",   categoria: "maria", ordem: 5, real: 5, titulo: "Guerra no Céu" },

    // ENSINOS DE JESUS (reais 6..23) - ordem interna 1..18
    { id: "jesus_escrituras",   categoria: "jesus", ordem: 1,  real: 6,  titulo: "O que Jesus ensinou sobre as Escrituras" },
    { id: "jesus_salvacao",     categoria: "jesus", ordem: 2,  real: 7,  titulo: "O que Jesus ensinou sobre a Salvação" },
    { id: "jesus_santificacao", categoria: "jesus", ordem: 3,  real: 8,  titulo: "O que Jesus ensinou sobre a Santificação" },
    { id: "jesus_espirito",     categoria: "jesus", ordem: 4,  real: 9,  titulo: "O que Jesus ensinou sobre o Espírito Santo" },
    { id: "jesus_oracao",       categoria: "jesus", ordem: 5,  real: 10, titulo: "O que Jesus ensinou sobre a Oração" },
    { id: "jesus_perdao",       categoria: "jesus", ordem: 6,  real: 11, titulo: "O que Jesus ensinou sobre o Perdão" },
    { id: "jesus_dinheiro",     categoria: "jesus", ordem: 7,  real: 12, titulo: "O que Jesus ensinou sobre o Dinheiro" },
    { id: "jesus_volta",        categoria: "jesus", ordem: 8,  real: 13, titulo: "O que Jesus ensinou sobre Sua Volta" },
    { id: "jesus_morte",        categoria: "jesus", ordem: 9,  real: 14, titulo: "O que Jesus ensinou sobre a Morte" },
    { id: "jesus_ressurreicao", categoria: "jesus", ordem: 10, real: 15, titulo: "O que Jesus ensinou sobre a Ressurreição" },
    { id: "jesus_juizo",        categoria: "jesus", ordem: 11, real: 16, titulo: "O que Jesus ensinou sobre o Juízo" },
    { id: "jesus_lei",          categoria: "jesus", ordem: 12, real: 17, titulo: "O que Jesus ensinou sobre a Lei" },
    { id: "jesus_sabado",       categoria: "jesus", ordem: 13, real: 18, titulo: "O que Jesus ensinou sobre o Sábado" },
    { id: "jesus_igreja",       categoria: "jesus", ordem: 14, real: 19, titulo: "O que Jesus ensinou sobre a Igreja" },
    { id: "jesus_profetas",     categoria: "jesus", ordem: 15, real: 20, titulo: "O que Jesus ensinou sobre os Profetas" },
    { id: "jesus_batismo",      categoria: "jesus", ordem: 16, real: 21, titulo: "O que Jesus ensinou sobre o Batismo" },
    { id: "jesus_corpo",        categoria: "jesus", ordem: 17, real: 22, titulo: "O que Jesus ensinou sobre o Cuidado com o Corpo" },
    { id: "jesus_ritos",        categoria: "jesus", ordem: 18, real: 23, titulo: "O que Jesus ensinou sobre Ritos e Tradições" },
];

const CATEGORIAS = {
    maria: { nome: "ESTUDO MARIA" },
    jesus: { nome: "ENSINOS DE JESUS" },
};

function getProvaById(id) {
    return PROVAS_CATALOG.find(p => p.id === id) || null;
}

function getProvasByCategoria(cat) {
    return PROVAS_CATALOG.filter(p => p.categoria === cat).sort((a, b) => a.ordem - b.ordem);
}

function getProvaByReal(n) {
    return PROVAS_CATALOG.find(p => p.real === n) || null;
}

function labelProva(meta) {
    // meta: {categoria, ordem, titulo}
    const catNome = (CATEGORIAS[meta.categoria] && CATEGORIAS[meta.categoria].nome) ? CATEGORIAS[meta.categoria].nome : meta.categoria;
    return `${catNome} — Prova ${meta.ordem} – ${meta.titulo}`;
}

// ========= UI: renderiza menus (HTML fica limpo) =========
function renderDropdownProvas() {
    const dd = document.getElementById("menu-provas-topo");
    if (!dd) return;

    dd.innerHTML = "";

    ["maria", "jesus"].forEach(cat => {
        const header = document.createElement("div");
        header.innerText = CATEGORIAS[cat].nome;
        header.style.fontWeight = "bold";
        header.style.background = "#f5f5f5";
        dd.appendChild(header);

        getProvasByCategoria(cat).forEach(p => {
            const item = document.createElement("div");
            // no topo mostramos "Prova X" (ordem interna)
            item.innerText = `Prova ${p.ordem} – ${p.titulo}`;
            item.onclick = () => mostrarIdentificacaoPorId(p.id);
            dd.appendChild(item);
        });
    });
}

function abrirCategoria(cat) {
    const menuCategorias = document.getElementById("menu-categorias");
    const submenu = document.getElementById("submenu-provas");
    const titulo = document.getElementById("titulo-categoria");
    const grid = document.getElementById("menu-provas-categoria");

    if (!menuCategorias || !submenu || !titulo || !grid) return;

    menuCategorias.style.display = "none";
    submenu.style.display = "block";
    titulo.innerText = CATEGORIAS[cat].nome;

    grid.innerHTML = "";
    getProvasByCategoria(cat).forEach(p => {
        const card = document.createElement("div");
        card.className = "menu-card";
        card.innerHTML = `
            <h3>Prova ${p.ordem}</h3>
            <p>${p.titulo}</p>
            <button onclick="mostrarIdentificacaoPorId('${p.id}')">INICIAR</button>
        `;
        grid.appendChild(card);
    });
}

function voltarCategorias() {
    const menuCategorias = document.getElementById("menu-categorias");
    const submenu = document.getElementById("submenu-provas");
    if (!menuCategorias || !submenu) return;

    submenu.style.display = "none";
    menuCategorias.style.display = "grid";
}

// ========= Compatibilidade (se ainda clicar em Prova 1..23) =========
function mostrarIdentificacaoPorNumero(provaReal) {
    const meta = getProvaByReal(provaReal);
    if (!meta) return;
    mostrarIdentificacaoPorId(meta.id);
}

function mostrarIdentificacaoPorId(provaId) {
    const meta = getProvaById(provaId);
    if (!meta) {
        alert("Prova não encontrada.");
        return;
    }

    // estado global
    provaIdAtual = meta.id;
    categoriaAtual = meta.categoria;
    ordemAtual = meta.ordem;
    atualProva = meta.real;

    document.getElementById("inicio").style.display = "none";
    document.getElementById("tela-identificacao").style.display = "flex";

    document.getElementById("id-titulo").innerText = labelProva(meta);

    setTimeout(() => {
        document.getElementById("nome-participante").focus();
    }, 0);
}

        // ------------------ FUNÇÕES ------------------

        function mostrarIdentificacao(prova) {
    // Mantém compatibilidade com chamadas antigas (1..23)
    // Agora o fluxo padrão é por ID técnico (provaId).
    mostrarIdentificacaoPorNumero(prova);
}

function iniciarProva() {
            let nome = document.getElementById("nome-participante").value.trim();
            if (nome === "") {
                alert("Digite seu nome antes de iniciar a prova.");
                return;
            }

            nome = nome.toUpperCase(); // GARANTIA FINAL
            nomeParticipante = nome;

            document.getElementById("nome-participante").value = nome;
            document.getElementById("tela-identificacao").style.display = "none";
            document.getElementById("prova-container").style.display = "flex";
            inicioTempo = Date.now();
            gerarProva();
        }

        function gerarProva() {
            const colLeft = document.getElementById("col-left");
            const colRight = document.getElementById("col-right");
            colLeft.innerHTML = "";
            colRight.innerHTML = "";
            const provaAtual = provas[atualProva];
            provaAtual.forEach((p, i) => {
                const div = document.createElement("div");
                div.className = "question";
                div.id = "q" + (i + 1);
                div.innerHTML = `<b>${i+1}. ${p[0]}</b><br>`;
                p[1].forEach((alt, j) => {
                    div.innerHTML += `<label><input type="radio" name="q${i+1}" value="${j===p[2]?1:0}"> ${alt}</label><br>`;
                });
                if (i < Math.ceil(provaAtual.length / 2)) colLeft.appendChild(div);
                else colRight.appendChild(div);
                div.querySelectorAll("input").forEach(input => {
                    input.addEventListener("change", () => {
                        div.classList.add("active");
                        if (i < provaAtual.length - 1) {
                            document.getElementById("q" + (i + 2)).classList.add("active");
                        } else {
                            document.getElementById("finalizar-btn").style.display = "block";
                        }
                    });
                });
            });
            document.getElementById("q1").classList.add("active");
            document.getElementById("finalizar-btn").style.display = "none";
        }

        function finalizarProva() {
            let nota = 0;
            let respostas = {};
            const provaAtual = provas[atualProva];

            for (let i = 1; i <= provaAtual.length; i++) {
                const q = document.getElementsByName("q" + i);
                q.forEach((input, index) => {
                    if (input.checked) {
                        nota += parseInt(input.value);
                        respostas["q" + i] = input.value;
                        respostas["q" + i + "-index"] = index;
                    }
                });
                if (!respostas["q" + i]) respostas["q" + i] = "";
            }

            const tempo = Math.floor((Date.now() - inicioTempo) / 1000);
            const dataAtual = new Date().toLocaleString();

            const meta = getProvaById(provaIdAtual) || getProvaByReal(atualProva);
            const provaLabel = meta ? labelProva(meta) : `Prova ${atualProva}`;

            if (!resultados[provaIdAtual || provaLabel]) {
                resultados[provaIdAtual || provaLabel] = {};
            }

            resultados[provaIdAtual || provaLabel][nomeParticipante] = {
                respostas,
                nota,
                tempo,
                data: dataAtual,
                provaId: provaIdAtual || null,
                categoria: meta ? meta.categoria : null,
                ordem: meta ? meta.ordem : null,
                titulo: meta ? meta.titulo : null,
                provaReal: atualProva
            };

            /* ===== ENVIO PARA GOOGLE SHEETS ===== */
            // Mantemos o campo "prova" como TEXTO amigável (compatível com planilha atual),
            // e enviamos também "provaId" para identificação técnica.
            const payload = {
                data: dataAtual,
                prova: provaLabel,
                provaId: provaIdAtual || null,
                provaReal: atualProva,
                categoria: meta ? meta.categoria : null,
                ordem: meta ? meta.ordem : null,
                titulo: meta ? meta.titulo : null,
                participante: nomeParticipante,
                nota: nota,
                tempo: tempo,
                respostas: respostas
            };

            enviarParaGoogleSheets(payload);
            /* =================================== */

            atualizarMenuResultados();
            mostrarResultadoIndividual((provaIdAtual || provaLabel), nomeParticipante);
        }

        function enviarParaGoogleSheets(dados) {
            fetch(GOOGLE_SHEETS_URL, {
                    method: "POST",
                    body: JSON.stringify(dados)
                })
                .then(res => res.json())
                .then(ret => {
                    if (ret.status !== "ok") {
                        console.warn("Google Sheets respondeu, mas não confirmou OK:", ret);
                    }
                })
                .catch(err => {
                    console.error("Erro ao enviar dados para Google Sheets:", err);
                });
        }

        function atualizarMenuResultados() {
            const menu = document.getElementById("menu-resultados");
            menu.innerHTML = "";
            if (Object.keys(resultados).length === 0) {
                menu.innerHTML = "<div>Nenhum resultado disponível</div>";
                return;
            }
            for (let prova in resultados) {
                for (let participante in resultados[prova]) {
                    const div = document.createElement("div");
                    const d = resultados[prova][participante];
                    const label = d && d.provaId ? (labelProva(getProvaById(d.provaId) || d) ) : prova;
                    div.innerText = `${label} – ${participante}`;
                    div.style.cursor = "pointer";
                    div.onclick = () => mostrarResultadoCompleto(prova, participante);
                    menu.appendChild(div);
                }
            }
        }

        function mostrarResultadoIndividual(prova, participante) {
            const dados = resultados[prova][participante];
            const status = dados.nota >= 7 ? "APROVADO" : "REPROVADO";
            const dmeta = dados.provaId ? (getProvaById(dados.provaId) || dados) : null;
            const provaLabel = dmeta ? labelProva(dmeta) : prova;
            document.getElementById("res-title").innerText = `Resultado — ${provaLabel}`;
            document.getElementById("res-participante").innerText = `Participante: ${participante}`;
            document.getElementById("res-nota").innerText = dados.nota; // somente número de acertos
            document.getElementById("res-tempo").innerText = `Tempo: ${dados.tempo} segundos`;
            document.getElementById("res-status").innerText = `Status: ${status}`;
            document.getElementById("res-msg").innerText = status === "APROVADO" ? "Parabéns! Você foi aprovado." : "Você não atingiu a nota mínima.";
            document.getElementById("resultado").style.display = "flex";
        }

        function mostrarResultadoCompleto(prova, participante) {
            const dados = resultados[prova][participante];
const provaIdReal = dados.provaReal || (function(){
    // compatibilidade com formato antigo "Prova 7" etc
    const m = String(prova).match(/\bProva\s+(\d+)/i);
    if (m) return parseInt(m[1], 10);

    // se for chave técnica (id), busca no catálogo
    const meta = getProvaById(prova);
    return meta ? meta.real : 1;
})();
const provaAtual = provas[provaIdReal]; // pega as questões
            const listaResultados = document.getElementById("lista-resultados");
            const labelCab = (dados.provaId && (getProvaById(dados.provaId) || dados)) ? labelProva(getProvaById(dados.provaId) || dados) : prova;
            listaResultados.innerHTML = `<h3>${labelCab} – ${participante}</h3>`;

            provaAtual.forEach((questao, i) => {
                const numero = i + 1;
                const div = document.createElement("div");
                div.style.border = "2px solid #2c7be5"; // borda azul
                div.style.borderRadius = "8px";
                div.style.padding = "12px";
                div.style.marginBottom = "12px";

                let alternativasHTML = "";
                const respostaUsuario = dados.respostas["q" + numero];
                const indiceCorreto = questao[2];
                const acertou = respostaUsuario == 1; // se marcou correta

                questao[1].forEach((alt, j) => {
                    const valorCorreto = (j === indiceCorreto);
                    // Apenas seleciona o radio se for a resposta do usuário
                    const marcado = (!acertou && respostaUsuario == 0 && j === parseInt(dados.respostas["q" + numero + "-index"])) ||
                        (acertou && valorCorreto);

                    alternativasHTML += `
        <label style="display:block; padding:6px; border-radius:4px;">
          <input type="radio" disabled ${marcado ? "checked" : ""}> ${alt}
        </label>
      `;
                });

                // Define fundo do bloco
                div.style.backgroundColor = acertou ? "#d4edda" : "#f8d7da";

                // Linha extra
                div.innerHTML = `<b>${numero}. ${questao[0]}</b><br>${alternativasHTML}`;
                if (!acertou) {
                    div.innerHTML += `<br><b>Resposta correta: ${String.fromCharCode(65 + indiceCorreto)}</b>`;
                }

                listaResultados.appendChild(div);
            });

            document.getElementById("tela-resultados").style.display = "flex";
        }

        function refazerProva() {
            document.getElementById("resultado").style.display = "none";
            document.getElementById("prova-container").style.display = "none";
            document.getElementById("tela-identificacao").style.display = "flex";
            document.getElementById("nome-participante").value = "";
        }
        
function proximaProva() {
    // Se não há prova atual definida por ID, tenta derivar do número real
    if (!provaIdAtual) {
        const m = getProvaByReal(atualProva);
        if (m) provaIdAtual = m.id;
    }

    const atualMeta = getProvaById(provaIdAtual);
    if (!atualMeta) {
        alert("Não foi possível identificar a próxima prova.");
        return;
    }

    const lista = getProvasByCategoria(atualMeta.categoria);
    const idx = lista.findIndex(p => p.id === atualMeta.id);

    if (idx < 0 || idx === lista.length - 1) {
        alert("Você já está na última prova dessa categoria.");
        return;
    }

    const prox = lista[idx + 1];

    document.getElementById("resultado").style.display = "none";
    mostrarIdentificacaoPorId(prox.id);
    document.getElementById("nome-participante").value = (nomeParticipante || "");
}

        function mostrarMenu() {
            document.getElementById("inicio").style.display = "flex";
            document.getElementById("tela-identificacao").style.display = "none";
            document.getElementById("prova-container").style.display = "none";
            document.getElementById("resultado").style.display = "none";
            document.getElementById("tela-resultados").style.display = "none";

            // Se estava dentro do submenu de provas por categoria, volta para as categorias
            const submenu = document.getElementById("submenu-provas");
            const menuCat = document.getElementById("menu-categorias");
            if (submenu && menuCat) {
                submenu.style.display = "none";
                menuCat.style.display = "grid";
            }
        }


        function fecharResultados() {
            document.getElementById("tela-resultados").style.display = "none";
            mostrarMenu();
        }

        /* PEGA DADOS DA PLANILHA RESULTADOS DO GOOGLE SHEETS E MOSTRA NO HTML */
        function carregarResultadosDoSheets() {
            fetch(GOOGLE_SHEETS_URL, {
                    method: "GET"
                })
                .then(res => res.json())
                .then(dados => {
                    // Se o Apps Script retornar erro em formato objeto:
                    if (dados && dados.status === "error") {
                        console.error("Sheets error:", dados.message);
                        return;
                    }

                    resultados = {};

                    dados.forEach(item => {
                        const chave = item.provaId || item.prova;
                        if (!resultados[chave]) resultados[chave] = {};

                        resultados[item.provaId || item.prova][item.participante] = {
                            nota: item.nota,
                            tempo: item.tempo,
                            data: item.data,
                            respostas: item.respostas || {},

                            // novos campos (podem não existir em resultados antigos)
                            provaId: item.provaId || (function(){
                                // tenta derivar pelo texto "Prova X" (quando era numérico)
                                const m = String(item.prova).match(/\bProva\s+(\d+)/i);
                                if (m) {
                                    const real = parseInt(m[1], 10);
                                    const meta = getProvaByReal(real);
                                    return meta ? meta.id : null;
                                }
                                return null;
                            })(),
                            provaReal: item.provaReal || (function(){
                                const m = String(item.prova).match(/\bProva\s+(\d+)/i);
                                return m ? parseInt(m[1], 10) : null;
                            })(),
                            categoria: item.categoria || null,
                            ordem: item.ordem || null,
                            titulo: item.titulo || null
                        };
                    });

                    atualizarMenuResultados();
                })
                .catch(err => {
                    console.error("Erro ao carregar resultados do Sheets:", err);
                });
        }

        window.onload = function() {
            renderDropdownProvas();
            carregarResultadosDoSheets();
        };

        // Atalho ESC para voltar ao menu principal
        document.addEventListener("keydown", function(event) {
            if (event.key === "Escape") {
                mostrarMenu();
            }
        });
    

(function setupDropdownsIOS() {
    const dropdowns = ["dd-provas", "dd-resultados"]
        .map(id => document.getElementById(id))
        .filter(Boolean);

    function closeAll(exceptEl = null) {
        dropdowns.forEach(d => {
            if (d !== exceptEl) d.classList.remove("open");
        });
    }

    function toggle(el) {
        const willOpen = !el.classList.contains("open");
        closeAll(el);
        if (willOpen) el.classList.add("open");
        else el.classList.remove("open");
    }

    // Tap imediato no iPhone (pointerdown cobre touch e mouse)
    dropdowns.forEach(el => {
        el.addEventListener("pointerdown", (e) => {
            // Se tocou dentro da lista (opções), não alterna o dropdown aqui
            if (e.target.closest(".dropdown-content")) return;

            e.preventDefault(); // evita seleção/hover do iOS
            e.stopPropagation();
            toggle(el);
        });
    });

    // Clique/toque fora fecha
    document.addEventListener("pointerdown", () => closeAll(), { passive: true });

    // Bloqueia menu de contexto por pressão longa
    dropdowns.forEach(el => {
        el.addEventListener("contextmenu", (e) => e.preventDefault());
    });

    // Tocar dentro do dropdown não fecha pelo listener global
    dropdowns.forEach(el => {
        const menu = el.querySelector(".dropdown-content");
        if (!menu) return;
        menu.addEventListener("pointerdown", (e) => {
            e.stopPropagation();
        });
    });

    // Ao escolher uma opção, fecha o dropdown
    dropdowns.forEach(el => {
        const menu = el.querySelector(".dropdown-content");
        if (!menu) return;
        menu.querySelectorAll("div").forEach(item => {
            item.addEventListener("pointerdown", () => {
                el.classList.remove("open");
            });
        });
    });
})();

</script>

</body>

</html>